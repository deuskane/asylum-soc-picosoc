; ;-----------------------------------------------------------------------------
; ; Title      : kcpsm3 file for identity fonction
; ; Project    : Asylum
; ;-----------------------------------------------------------------------------
; ; File       : identity.psm
; ; Author     : mrosiere
; ;-----------------------------------------------------------------------------
; ; Description:
; ; Read  switch
; ; Write led
; ;-----------------------------------------------------------------------------
; ; Copyright (c) 2021
; ;-----------------------------------------------------------------------------
; ; Revisions  :
; ; Date        Version  Author   Description
; ; 2017-03-30  1.0      mrosiere Created
; ;-----------------------------------------------------------------------------

; ;------------------------------------
; ; Identity function : read switch and write in led
; ;
; ;------------------------------------

; ;------------------------------------
; ; Constantes
; ;------------------------------------
sp                  EQU       sF

; ;------------------------------------
; ; directives pour le simulateur:  definition des  E/S
; ;------------------------------------
switch_id           EQU       $10
led_id              EQU       $20

switch              DSIN      switch_id
led                 DSOUT     led_id

; ;------------------------------------
; ; MAIN
; ;------------------------------------
                    ORG       $00
main: 
main_loop: 
                    IN        s0, switch_id
                    OUT       s0, led_id
                    JUMP      main_loop

; ;------------------------------------
; ; Interrupt VECTOR
; ;------------------------------------
                    ORG       $3FF
                    RETI      ENABLE
